# 전국 신규 민간 아파트 분양가격 동향

2013년부터 최근까지 부동산 가격 변동 추세가 아파트 분양가에도 반영될까요? 공공데이터 포털에 있는 데이터를 Pandas 의 melt, concat, pivot, transpose 와 같은 reshape 기능을 활용해 분석해 봅니다. 그리고 groupby, pivot_table, info, describe, value_counts 등을 통한 데이터 요약과 분석을 해봅니다. 이를 통해 전혀 다른 형태의 두 데이터를 가져와 정제하고 병합하는 과정을 다루는 방법을 알게 됩니다. 전처리 한 결과에 대해 수치형, 범주형 데이터의 차이를 이해하고 다양한 그래프로 시각화를 할 수 있게 됩니다.

## 다루는 내용

* 공공데이터를 활용해 전혀 다른 두 개의 데이터를 가져와서 전처리 하고 병합하기
* 수치형 데이터와 범주형 데이터를 바라보는 시각을 기르기
* 데이터의 형식에 따른 다양한 시각화 방법 이해하기

## 실습

* 공공데이터 다운로드 후 주피터 노트북으로 로드하기
* 판다스를 통해 데이터를 요약하고 분석하기
* 데이터 전처리와 병합하기
* 수치형 데이터와 범주형 데이터 다루기
* 막대그래프(bar plot), 선그래프(line plot), 산포도(scatter plot), 상관관계(lm plot), 히트맵, 상자수염그림, swarm plot, 도수분포표, 히스토그램(distplot) 실습하기

## 데이터셋

* 다운로드 위치 : 
    * 공공데이터 포털 : https://www.data.go.kr/data/15061057/fileData.do
    * 수업과 같은 데이터로 실습하기 위해 아래 링크의 데이터로 실습하는 것을 권장합니다.
    * 데이터셋 다운로드(구글드라이브) : http://bit.ly/open-data-set-folder
    * 데이터셋 다운로드(드랍박스) : https://bit.ly/dropbox-open-data-set

### 전국 평균 분양가격(2013년 9월부터 2015년 8월까지)

* 전국 공동주택의 3.3제곱미터당 평균분양가격 데이터를 제공

###  주택도시보증공사_전국 평균 분양가격(2019년 12월)

* 전국 공동주택의 연도별, 월별, 전용면적별 제곱미터당 평균분양가격 데이터를 제공
* 지역별 평균값은 단순 산술평균값이 아닌 가중평균값임

```python
# %가 들어가는 명령은 command line 명령어 입니다. 
# 터미널에서 사용할 수 있는 명령을 주피터 노트북 안에서 사용할 수 있습니다.
# 매직커맨드라고 불리는 이 명령이 운영체제에 따라 다르게 동작하거나 동작하지 않을 수도 있으니 그렇다면 다음 셀을 참고해서 파일 목록을 실행해 보세요.
%ls data
```

<pre>
baseball.csv
click_sample_data.csv
encoding_sample_data.csv
fake_stock_price.csv
ice_cream_production_for_us.csv
interactive_candle_stick.html
interior_effect.csv
students.csv
...
31m전국 평균 분양가격(2013년 9월부터 2015년 8월까지).csv
</pre>

```python
import os
# os.walk 를 통해 특정 폴더 안의 파일을 읽어옵니다.
for root, dirs, files in os.walk("data"):
    print(dirs)
```

<pre>
['stock_data']
['stocks', 'etfs']
...
</pre>

```python
# 파이썬에서 쓸 수 있는 엑셀과도 유사한 판다스 라이브러리를 불러옵니다.
import pandas as pd
import numpy as np

# 경고 메시지는 출력되지 않게 합니다.
import warnings
warnings.filterwarnings("ignore")
```

## 데이터 로드

### 최근 파일 로드

공공데이터 포털에서 "주택도시보증공사_전국 평균 분양가격"파일을 다운로드 받아 불러옵니다.

이 때, 인코딩을 설정을 해주어야 한글이 깨지지 않습니다.

보통 엑셀로 저장된 한글의 인코딩은 cp949 혹은 euc-kr로 되어 있습니다.

df_last 라는 변수에 최근 분양가 파일을 다운로드 받아 로드합니다.

* 한글인코딩 : [‘설믜를 설믜라 못 부르는’ 김설믜씨 “제 이름을 지켜주세요” : 사회일반 : 사회 : 뉴스 : 한겨레](http://www.hani.co.kr/arti/society/society_general/864914.html)

데이터를 로드한 뒤 shape를 통해 행과 열의 갯수를 출력합니다.

```python
# 최근 분양가 파일을 로드해서 df_last 라는 변수에 담습니다.
# 파일로드시 OSError가 발생한다면, engine="python"을 추가해 보세요.
df_last = pd.read_csv("data/주택도시보증공사_전국 평균 분양가격(2019년 12월).csv", encoding="cp949", engine="python")
df_last.shape
```

<pre>
(4335, 5)
</pre>

```python
# head 로 파일을 미리보기 합니다.

df_last.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>규모구분</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격(㎡)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>전체</td>
      <td>2015</td>
      <td>10</td>
      <td>5841</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서울</td>
      <td>전용면적 60㎡이하</td>
      <td>2015</td>
      <td>10</td>
      <td>5652</td>
    </tr>
    <tr>
      <th>2</th>
      <td>서울</td>
      <td>전용면적 60㎡초과 85㎡이하</td>
      <td>2015</td>
      <td>10</td>
      <td>5882</td>
    </tr>
    <tr>
      <th>3</th>
      <td>서울</td>
      <td>전용면적 85㎡초과 102㎡이하</td>
      <td>2015</td>
      <td>10</td>
      <td>5721</td>
    </tr>
    <tr>
      <th>4</th>
      <td>서울</td>
      <td>전용면적 102㎡초과</td>
      <td>2015</td>
      <td>10</td>
      <td>5879</td>
    </tr>
  </tbody>
</table>
</div>

```python
# tail 로도 미리보기를 합니다.

df_last.tail()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>규모구분</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격(㎡)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4330</th>
      <td>제주</td>
      <td>전체</td>
      <td>2019</td>
      <td>12</td>
      <td>3882</td>
    </tr>
    <tr>
      <th>4331</th>
      <td>제주</td>
      <td>전용면적 60㎡이하</td>
      <td>2019</td>
      <td>12</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4332</th>
      <td>제주</td>
      <td>전용면적 60㎡초과 85㎡이하</td>
      <td>2019</td>
      <td>12</td>
      <td>3898</td>
    </tr>
    <tr>
      <th>4333</th>
      <td>제주</td>
      <td>전용면적 85㎡초과 102㎡이하</td>
      <td>2019</td>
      <td>12</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4334</th>
      <td>제주</td>
      <td>전용면적 102㎡초과</td>
      <td>2019</td>
      <td>12</td>
      <td>3601</td>
    </tr>
  </tbody>
</table>
</div>


### 2015년 부터 최근까지의 데이터 로드

전국 평균 분양가격(2013년 9월부터 2015년 8월까지) 파일을 불러옵니다.

df_first 라는 변수에 담고 shape로 행과 열의 갯수를 출력합니다.

```python
# 해당되는 폴더 혹은 경로의 파일 목록을 출력해 줍니다.

%ls data
```

<pre>
baseball.csv
click_sample_data.csv
encoding_sample_data.csv
fake_stock_price.csv
ice_cream_production_for_us.csv
interactive_candle_stick.html
interior_effect.csv
students.csv
...
31m전국 평균 분양가격(2013년 9월부터 2015년 8월까지).csv
</pre>

```python
df_first = pd.read_csv("data/전국 평균 분양가격(2013년 9월부터 2015년 8월까지).csv", 
                       encoding="cp949")
df_first.shape
```

<pre>
(17, 22)
</pre>

```python
# df_first 변수에 담긴 데이터프레임을 head로 미리보기 합니다.

df_first.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>2013년12월</th>
      <th>2014년1월</th>
      <th>2014년2월</th>
      <th>2014년3월</th>
      <th>2014년4월</th>
      <th>2014년5월</th>
      <th>2014년6월</th>
      <th>2014년7월</th>
      <th>2014년8월</th>
      <th>2014년9월</th>
      <th>2014년10월</th>
      <th>2014년11월</th>
      <th>2014년12월</th>
      <th>2015년1월</th>
      <th>2015년2월</th>
      <th>2015년3월</th>
      <th>2015년4월</th>
      <th>2015년5월</th>
      <th>2015년6월</th>
      <th>2015년7월</th>
      <th>2015년8월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>18189</td>
      <td>17925</td>
      <td>17925</td>
      <td>18016</td>
      <td>18098</td>
      <td>19446</td>
      <td>18867</td>
      <td>18742</td>
      <td>19274</td>
      <td>19404</td>
      <td>19759</td>
      <td>20242</td>
      <td>20269</td>
      <td>20670</td>
      <td>20670</td>
      <td>19415</td>
      <td>18842</td>
      <td>18367</td>
      <td>18374</td>
      <td>18152</td>
      <td>18443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>부산</td>
      <td>8111</td>
      <td>8111</td>
      <td>9078</td>
      <td>8965</td>
      <td>9402</td>
      <td>9501</td>
      <td>9453</td>
      <td>9457</td>
      <td>9411</td>
      <td>9258</td>
      <td>9110</td>
      <td>9208</td>
      <td>9208</td>
      <td>9204</td>
      <td>9235</td>
      <td>9279</td>
      <td>9327</td>
      <td>9345</td>
      <td>9515</td>
      <td>9559</td>
      <td>9581</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구</td>
      <td>8080</td>
      <td>8080</td>
      <td>8077</td>
      <td>8101</td>
      <td>8267</td>
      <td>8274</td>
      <td>8360</td>
      <td>8360</td>
      <td>8370</td>
      <td>8449</td>
      <td>8403</td>
      <td>8439</td>
      <td>8253</td>
      <td>8327</td>
      <td>8416</td>
      <td>8441</td>
      <td>8446</td>
      <td>8568</td>
      <td>8542</td>
      <td>8542</td>
      <td>8795</td>
    </tr>
    <tr>
      <th>3</th>
      <td>인천</td>
      <td>10204</td>
      <td>10204</td>
      <td>10408</td>
      <td>10408</td>
      <td>10000</td>
      <td>9844</td>
      <td>10058</td>
      <td>9974</td>
      <td>9973</td>
      <td>9973</td>
      <td>10016</td>
      <td>10020</td>
      <td>10020</td>
      <td>10017</td>
      <td>9876</td>
      <td>9876</td>
      <td>9938</td>
      <td>10551</td>
      <td>10443</td>
      <td>10443</td>
      <td>10449</td>
    </tr>
    <tr>
      <th>4</th>
      <td>광주</td>
      <td>6098</td>
      <td>7326</td>
      <td>7611</td>
      <td>7346</td>
      <td>7346</td>
      <td>7523</td>
      <td>7659</td>
      <td>7612</td>
      <td>7622</td>
      <td>7802</td>
      <td>7707</td>
      <td>7752</td>
      <td>7748</td>
      <td>7752</td>
      <td>7756</td>
      <td>7861</td>
      <td>7914</td>
      <td>7877</td>
      <td>7881</td>
      <td>8089</td>
      <td>8231</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_first 변수에 담긴 데이터프레임을 tail로 미리보기 합니다.

df_first.tail()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>2013년12월</th>
      <th>2014년1월</th>
      <th>2014년2월</th>
      <th>2014년3월</th>
      <th>2014년4월</th>
      <th>2014년5월</th>
      <th>2014년6월</th>
      <th>2014년7월</th>
      <th>2014년8월</th>
      <th>2014년9월</th>
      <th>2014년10월</th>
      <th>2014년11월</th>
      <th>2014년12월</th>
      <th>2015년1월</th>
      <th>2015년2월</th>
      <th>2015년3월</th>
      <th>2015년4월</th>
      <th>2015년5월</th>
      <th>2015년6월</th>
      <th>2015년7월</th>
      <th>2015년8월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>전북</td>
      <td>6282</td>
      <td>6281</td>
      <td>5946</td>
      <td>5966</td>
      <td>6277</td>
      <td>6306</td>
      <td>6351</td>
      <td>6319</td>
      <td>6436</td>
      <td>6719</td>
      <td>6581</td>
      <td>6583</td>
      <td>6583</td>
      <td>6583</td>
      <td>6583</td>
      <td>6542</td>
      <td>6551</td>
      <td>6556</td>
      <td>6601</td>
      <td>6750</td>
      <td>6580</td>
    </tr>
    <tr>
      <th>13</th>
      <td>전남</td>
      <td>5678</td>
      <td>5678</td>
      <td>5678</td>
      <td>5696</td>
      <td>5736</td>
      <td>5656</td>
      <td>5609</td>
      <td>5780</td>
      <td>5685</td>
      <td>5804</td>
      <td>5753</td>
      <td>5768</td>
      <td>5784</td>
      <td>5784</td>
      <td>5833</td>
      <td>5825</td>
      <td>5940</td>
      <td>6050</td>
      <td>6243</td>
      <td>6286</td>
      <td>6289</td>
    </tr>
    <tr>
      <th>14</th>
      <td>경북</td>
      <td>6168</td>
      <td>6168</td>
      <td>6234</td>
      <td>6317</td>
      <td>6412</td>
      <td>6409</td>
      <td>6554</td>
      <td>6556</td>
      <td>6563</td>
      <td>6577</td>
      <td>6778</td>
      <td>6881</td>
      <td>6989</td>
      <td>6992</td>
      <td>6953</td>
      <td>6997</td>
      <td>7006</td>
      <td>6966</td>
      <td>6887</td>
      <td>7035</td>
      <td>7037</td>
    </tr>
    <tr>
      <th>15</th>
      <td>경남</td>
      <td>6473</td>
      <td>6485</td>
      <td>6502</td>
      <td>6610</td>
      <td>6599</td>
      <td>6610</td>
      <td>6615</td>
      <td>6613</td>
      <td>6606</td>
      <td>6767</td>
      <td>6881</td>
      <td>7125</td>
      <td>7332</td>
      <td>7592</td>
      <td>7588</td>
      <td>7668</td>
      <td>7683</td>
      <td>7717</td>
      <td>7715</td>
      <td>7723</td>
      <td>7665</td>
    </tr>
    <tr>
      <th>16</th>
      <td>제주</td>
      <td>7674</td>
      <td>7900</td>
      <td>7900</td>
      <td>7900</td>
      <td>7900</td>
      <td>7900</td>
      <td>7914</td>
      <td>7914</td>
      <td>7914</td>
      <td>7833</td>
      <td>7724</td>
      <td>7724</td>
      <td>7739</td>
      <td>7739</td>
      <td>7739</td>
      <td>7826</td>
      <td>7285</td>
      <td>7285</td>
      <td>7343</td>
      <td>7343</td>
      <td>7343</td>
    </tr>
  </tbody>
</table>
</div>

### 데이터 요약하기

```python
df_last.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4335 entries, 0 to 4334
Data columns (total 5 columns):
 #   Column   Non-Null Count  Dtype 
---  ------   --------------  ----- 
 0   지역명      4335 non-null   object
 1   규모구분     4335 non-null   object
 2   연도       4335 non-null   int64 
 3   월        4335 non-null   int64 
 4   분양가격(㎡)  4058 non-null   object
dtypes: int64(2), object(3)
memory usage: 169.5+ KB
</pre>

### 결측치 보기

isnull 혹은 isna 를 통해 데이터가 비어있는지를 확인할 수 있습니다.
결측치는 True로 표시되는데, True == 1 이기 때문에 이 값을 다 더해주면 결측치의 수가 됩니다.

```python
True == 1
```

<pre>
True
</pre>

```python
False == 0
```

<pre>
True
</pre>

```python
True + True + False
```

<pre>
2
</pre>

```python
df_last.isnull()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>규모구분</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격(㎡)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4330</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4331</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4332</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4333</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4334</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>4335 rows × 5 columns</p>
</div>

```python
# isnull 을 통해 결측치를 구합니다.
df_last.isnull().sum()
```

<pre>
지역명          0
규모구분         0
연도           0
월            0
분양가격(㎡)    277
dtype: int64
</pre>

```python
# isna 를 통해 결측치를 구합니다.

df_last.isna().sum()
```

<pre>
지역명          0
규모구분         0
연도           0
월            0
분양가격(㎡)    277
dtype: int64
</pre>

### 데이터 타입 변경

분양가격이 object(문자) 타입으로 되어 있습니다. 문자열 타입을 계산할 수 없기 때문에 수치 데이터로 변경해 줍니다. 결측치가 섞여 있을 때 변환이 제대로 되지 않습니다. 그래서 pd.to_numeric 을 통해 데이터의 타입을 변경합니다.

```python
type(np.nan)
```

<pre>
float
</pre>

```python
df_last["분양가격"] = pd.to_numeric(df_last["분양가격(㎡)"], errors='coerce')
df_last["분양가격"].head(1)
```

<pre>
0    5841.0
Name: 분양가격, dtype: float64
</pre>
### 평당분양가격 구하기

공공데이터포털에 올라와 있는 2013년부터의 데이터는 평당분양가격 기준으로 되어 있습니다.

분양가격을 평당기준으로 보기위해 3.3을 곱해서 "평당분양가격" 컬럼을 만들어 추가해 줍니다.

```python
df_last["평당분양가격"] = df_last["분양가격"] * 3.3
df_last.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>규모구분</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격(㎡)</th>
      <th>분양가격</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>전체</td>
      <td>2015</td>
      <td>10</td>
      <td>5841</td>
      <td>5841.0</td>
      <td>19275.3</td>
    </tr>
  </tbody>
</table>
</div>

### 분양가격 요약하기

```python
# info를 통해 분양가격을 봅니다.

df_last.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4335 entries, 0 to 4334
Data columns (total 7 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   지역명      4335 non-null   object 
 1   규모구분     4335 non-null   object 
 2   연도       4335 non-null   int64  
 3   월        4335 non-null   int64  
 4   분양가격(㎡)  4058 non-null   object 
 5   분양가격     3957 non-null   float64
 6   평당분양가격   3957 non-null   float64
dtypes: float64(2), int64(2), object(3)
memory usage: 237.2+ KB
</pre>

```python
# 변경 전 컬럼인 분양가격(㎡) 컬럼을 요약합니다.
# object type일 때는 결측치도 데이터가 있는 것으로 간주
# 가장 빈번하게 등장하는 문자열이 2221, 이것이 17번 등장

df_last["분양가격(㎡)"].describe()
```

<pre>
count     4058
unique    1753
top       2221
freq        17
Name: 분양가격(㎡), dtype: object
</pre>

```python
df_last["분양가격(㎡)"].nunique()
```

<pre>
1753
</pre>

```python
# 수치데이터로 변경된 분양가격 컬럼을 요약합니다.

df_last["분양가격"].describe()
```

<pre>
count     3957.000000
mean      3238.128633
std       1264.309933
min       1868.000000
25%       2441.000000
50%       2874.000000
75%       3561.000000
max      12728.000000
Name: 분양가격, dtype: float64
</pre>

### 규모구분을 전용면적 컬럼으로 변경

규모구분 컬럼은 전용면적에 대한 내용이 있습니다. 전용면적이라는 문구가 공통적으로 들어가고 규모구분보다는 전용면적이 좀 더 직관적이기 때문에 전용면적이라는 컬럼을 새로 만들어주고 기존 규모구분의 값에서 전용면적, 초과, 이하 등의 문구를 빼고 간결하게 만들어 봅니다.

이 때 str 의 replace 기능을 사용해서 예를들면 "전용면적 60㎡초과 85㎡이하"라면 "60㎡~85㎡" 로 변경해 줍니다.

* pandas 의 string-handling 기능을 좀 더 보고 싶다면 :

https://pandas.pydata.org/pandas-docs/stable/reference/series.html#string-handling

```python
df_last["규모구분"].unique()
```

<pre>
array(['전체', '전용면적 60㎡이하', '전용면적 60㎡초과 85㎡이하', '전용면적 85㎡초과 102㎡이하',
       '전용면적 102㎡초과'], dtype=object)
</pre>

```python
df_last["전용면적"] = df_last["규모구분"].str.replace("전용면적", "")
df_last["전용면적"] = df_last["전용면적"].str.replace("초과", "~")
df_last["전용면적"] = df_last["전용면적"].str.replace("이하", "")
df_last["전용면적"] = df_last["전용면적"].str.replace(" ", "").str.strip()
df_last["전용면적"]
```

<pre>
0             전체
1            60㎡
2        60㎡~85㎡
3       85㎡~102㎡
4          102㎡~
          ...   
4330          전체
4331         60㎡
4332     60㎡~85㎡
4333    85㎡~102㎡
4334       102㎡~
Name: 전용면적, Length: 4335, dtype: object
</pre>

### 필요없는 컬럼 제거하기

drop을 통해 전처리 해준 컬럼을 제거합니다. pandas의 데이터프레임과 관련된 메소드에는 axis 옵션이 필요할 때가 있는데 행과 열중 어떤 기준으로 처리를 할 것인지를 의미합니다. 보통 기본적으로 0으로 되어 있고 행을 기준으로 처리함을 의미합니다. 메모리 사용량이 줄어들었는지 확인합니다.

```python
df_last.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4335 entries, 0 to 4334
Data columns (total 8 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   지역명      4335 non-null   object 
 1   규모구분     4335 non-null   object 
 2   연도       4335 non-null   int64  
 3   월        4335 non-null   int64  
 4   분양가격(㎡)  4058 non-null   object 
 5   분양가격     3957 non-null   float64
 6   평당분양가격   3957 non-null   float64
 7   전용면적     4335 non-null   object 
dtypes: float64(2), int64(2), object(4)
memory usage: 271.1+ KB
</pre>

```python
# drop 사용시 axis에 유의 합니다.
# axis 0:행, 1:열
df_last = df_last.drop(["규모구분", "분양가격(㎡)"], axis=1)
```

```python
# 제거가 잘 되었는지 확인 합니다.
df_last.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격</th>
      <th>평당분양가격</th>
      <th>전용면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5841.0</td>
      <td>19275.3</td>
      <td>전체</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 컬럼 제거를 통해 메모리 사용량이 줄어들었는지 확인합니다.
df_last.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 4335 entries, 0 to 4334
Data columns (total 6 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   지역명     4335 non-null   object 
 1   연도      4335 non-null   int64  
 2   월       4335 non-null   int64  
 3   분양가격    3957 non-null   float64
 4   평당분양가격  3957 non-null   float64
 5   전용면적    4335 non-null   object 
dtypes: float64(2), int64(2), object(2)
memory usage: 203.3+ KB
</pre>

## groupby 로 데이터 집계하기

groupby 를 통해 데이터를 그룹화해서 연산을 해봅니다.

```python
# 지역명으로 분양가격의 평균을 구하고 막대그래프(bar)로 시각화 합니다.
# df.groupby(["인덱스로 사용할 컬럼명"])["계산할 컬럼 값"].연산()
df_last.groupby(["지역명"])["평당분양가격"].mean()
```

<pre>
지역명
강원     7890.750000
경기    13356.895200
경남     9268.778138
경북     8376.536515
광주     9951.535821
대구    11980.895455
대전    10253.333333
부산    12087.121200
서울    23599.976400
세종     9796.516456
울산    10014.902013
인천    11915.320732
전남     7565.316532
전북     7724.235484
제주    11241.276712
충남     8233.651883
충북     7634.655600
Name: 평당분양가격, dtype: float64
</pre>

```python
# 전용면적으로 분양가격의 평균을 구합니다.
df_last.groupby(["전용면적"])["평당분양가격"].mean()
```

<pre>
전용면적
102㎡~       11517.705634
60㎡         10375.137421
60㎡~85㎡     10271.040071
85㎡~102㎡    11097.599573
전체          10276.086207
Name: 평당분양가격, dtype: float64
</pre>

```python
# 지역명, 전용면적으로 평당분양가격의 평균을 구합니다.
# unstack()하면 groupby할 변수 중 마지막이 컬럼값으로 옴
df_last.groupby(["전용면적", "지역명"])["평당분양가격"].mean().unstack().round()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>지역명</th>
      <th>강원</th>
      <th>경기</th>
      <th>경남</th>
      <th>경북</th>
      <th>광주</th>
      <th>대구</th>
      <th>대전</th>
      <th>부산</th>
      <th>서울</th>
      <th>세종</th>
      <th>울산</th>
      <th>인천</th>
      <th>전남</th>
      <th>전북</th>
      <th>제주</th>
      <th>충남</th>
      <th>충북</th>
    </tr>
    <tr>
      <th>전용면적</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>102㎡~</th>
      <td>8311.0</td>
      <td>14772.0</td>
      <td>10358.0</td>
      <td>9157.0</td>
      <td>11042.0</td>
      <td>13087.0</td>
      <td>14877.0</td>
      <td>13208.0</td>
      <td>23446.0</td>
      <td>10107.0</td>
      <td>9974.0</td>
      <td>14362.0</td>
      <td>8168.0</td>
      <td>8194.0</td>
      <td>10523.0</td>
      <td>8689.0</td>
      <td>8195.0</td>
    </tr>
    <tr>
      <th>60㎡</th>
      <td>7567.0</td>
      <td>13252.0</td>
      <td>8689.0</td>
      <td>7883.0</td>
      <td>9431.0</td>
      <td>11992.0</td>
      <td>9176.0</td>
      <td>11354.0</td>
      <td>23213.0</td>
      <td>9324.0</td>
      <td>9202.0</td>
      <td>11241.0</td>
      <td>7210.0</td>
      <td>7610.0</td>
      <td>14022.0</td>
      <td>7911.0</td>
      <td>7103.0</td>
    </tr>
    <tr>
      <th>60㎡~85㎡</th>
      <td>7486.0</td>
      <td>12524.0</td>
      <td>8619.0</td>
      <td>8061.0</td>
      <td>9911.0</td>
      <td>11779.0</td>
      <td>9711.0</td>
      <td>11865.0</td>
      <td>22787.0</td>
      <td>9775.0</td>
      <td>10503.0</td>
      <td>11384.0</td>
      <td>7269.0</td>
      <td>7271.0</td>
      <td>10621.0</td>
      <td>7819.0</td>
      <td>7264.0</td>
    </tr>
    <tr>
      <th>85㎡~102㎡</th>
      <td>8750.0</td>
      <td>13678.0</td>
      <td>10018.0</td>
      <td>8774.0</td>
      <td>9296.0</td>
      <td>11141.0</td>
      <td>9037.0</td>
      <td>12073.0</td>
      <td>25944.0</td>
      <td>9848.0</td>
      <td>8861.0</td>
      <td>11528.0</td>
      <td>7909.0</td>
      <td>8276.0</td>
      <td>10709.0</td>
      <td>9120.0</td>
      <td>8391.0</td>
    </tr>
    <tr>
      <th>전체</th>
      <td>7478.0</td>
      <td>12560.0</td>
      <td>8659.0</td>
      <td>8079.0</td>
      <td>9904.0</td>
      <td>11771.0</td>
      <td>9786.0</td>
      <td>11936.0</td>
      <td>22610.0</td>
      <td>9805.0</td>
      <td>10493.0</td>
      <td>11257.0</td>
      <td>7284.0</td>
      <td>7293.0</td>
      <td>10785.0</td>
      <td>7815.0</td>
      <td>7219.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 연도, 지역명으로 평당분양가격의 평균을 구합니다.

g = df_last.groupby(["연도", "지역명"])["평당분양가격"].mean()
g
# transpose()를 통해 레코드, 열 전치 가능
# g.unstack().transpose()
```

<pre>
연도    지역명
2015  강원      7188.060000
      경기     11060.940000
      경남      8459.220000
      경북      7464.160000
      광주      7916.700000
                 ...     
2019  전남      8219.275862
      전북      8532.260000
      제주     11828.469231
      충남      8748.840000
      충북      7970.875000
Name: 평당분양가격, Length: 85, dtype: float64
</pre>

```python
g.loc[2018]
```

<pre>
지역명
강원     8219.255000
경기    14258.420000
경남     9327.670000
경북     8680.776923
광주     9526.953333
대구    12139.252632
대전    10234.106667
부산    12889.965000
서울    23202.245000
세종    10340.463158
울산    10241.400000
인천    11881.532143
전남     7929.845000
전북     8174.595000
제주    11935.968000
충남     8201.820000
충북     8149.295000
Name: 평당분양가격, dtype: float64
</pre>

```python
g.unstack()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>지역명</th>
      <th>강원</th>
      <th>경기</th>
      <th>경남</th>
      <th>경북</th>
      <th>광주</th>
      <th>대구</th>
      <th>대전</th>
      <th>부산</th>
      <th>서울</th>
      <th>세종</th>
      <th>울산</th>
      <th>인천</th>
      <th>전남</th>
      <th>전북</th>
      <th>제주</th>
      <th>충남</th>
      <th>충북</th>
    </tr>
    <tr>
      <th>연도</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015</th>
      <td>7188.060000</td>
      <td>11060.94</td>
      <td>8459.220000</td>
      <td>7464.160000</td>
      <td>7916.700000</td>
      <td>9018.900000</td>
      <td>8190.600000</td>
      <td>10377.400</td>
      <td>20315.680</td>
      <td>8765.020000</td>
      <td>9367.600000</td>
      <td>10976.020000</td>
      <td>6798.880000</td>
      <td>7110.400000</td>
      <td>7951.075000</td>
      <td>7689.880000</td>
      <td>6828.800</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>7162.903846</td>
      <td>11684.97</td>
      <td>8496.730000</td>
      <td>7753.405000</td>
      <td>9190.683333</td>
      <td>10282.030000</td>
      <td>8910.733333</td>
      <td>10743.535</td>
      <td>21753.435</td>
      <td>8857.805000</td>
      <td>9582.574138</td>
      <td>11099.055000</td>
      <td>6936.600000</td>
      <td>6906.625000</td>
      <td>9567.480000</td>
      <td>7958.225000</td>
      <td>7133.335</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>7273.560000</td>
      <td>12304.98</td>
      <td>8786.760000</td>
      <td>8280.800000</td>
      <td>9613.977551</td>
      <td>12206.700000</td>
      <td>9957.158491</td>
      <td>11560.680</td>
      <td>21831.060</td>
      <td>9132.505556</td>
      <td>10666.935714</td>
      <td>11640.600000</td>
      <td>7372.920000</td>
      <td>7398.973585</td>
      <td>12566.730000</td>
      <td>8198.422222</td>
      <td>7473.120</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>8219.255000</td>
      <td>14258.42</td>
      <td>9327.670000</td>
      <td>8680.776923</td>
      <td>9526.953333</td>
      <td>12139.252632</td>
      <td>10234.106667</td>
      <td>12889.965</td>
      <td>23202.245</td>
      <td>10340.463158</td>
      <td>10241.400000</td>
      <td>11881.532143</td>
      <td>7929.845000</td>
      <td>8174.595000</td>
      <td>11935.968000</td>
      <td>8201.820000</td>
      <td>8149.295</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>8934.475000</td>
      <td>15665.54</td>
      <td>10697.615789</td>
      <td>9050.250000</td>
      <td>12111.675000</td>
      <td>14081.650000</td>
      <td>12619.200000</td>
      <td>13537.865</td>
      <td>28286.830</td>
      <td>11299.394118</td>
      <td>10216.250000</td>
      <td>13249.775000</td>
      <td>8219.275862</td>
      <td>8532.260000</td>
      <td>11828.469231</td>
      <td>8748.840000</td>
      <td>7970.875</td>
    </tr>
  </tbody>
</table>
</div>

```python
g.unstack().transpose()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>연도</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>지역명</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강원</th>
      <td>7188.060</td>
      <td>7162.903846</td>
      <td>7273.560000</td>
      <td>8219.255000</td>
      <td>8934.475000</td>
    </tr>
    <tr>
      <th>경기</th>
      <td>11060.940</td>
      <td>11684.970000</td>
      <td>12304.980000</td>
      <td>14258.420000</td>
      <td>15665.540000</td>
    </tr>
    <tr>
      <th>경남</th>
      <td>8459.220</td>
      <td>8496.730000</td>
      <td>8786.760000</td>
      <td>9327.670000</td>
      <td>10697.615789</td>
    </tr>
    <tr>
      <th>경북</th>
      <td>7464.160</td>
      <td>7753.405000</td>
      <td>8280.800000</td>
      <td>8680.776923</td>
      <td>9050.250000</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>7916.700</td>
      <td>9190.683333</td>
      <td>9613.977551</td>
      <td>9526.953333</td>
      <td>12111.675000</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>9018.900</td>
      <td>10282.030000</td>
      <td>12206.700000</td>
      <td>12139.252632</td>
      <td>14081.650000</td>
    </tr>
    <tr>
      <th>대전</th>
      <td>8190.600</td>
      <td>8910.733333</td>
      <td>9957.158491</td>
      <td>10234.106667</td>
      <td>12619.200000</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>10377.400</td>
      <td>10743.535000</td>
      <td>11560.680000</td>
      <td>12889.965000</td>
      <td>13537.865000</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>20315.680</td>
      <td>21753.435000</td>
      <td>21831.060000</td>
      <td>23202.245000</td>
      <td>28286.830000</td>
    </tr>
    <tr>
      <th>세종</th>
      <td>8765.020</td>
      <td>8857.805000</td>
      <td>9132.505556</td>
      <td>10340.463158</td>
      <td>11299.394118</td>
    </tr>
    <tr>
      <th>울산</th>
      <td>9367.600</td>
      <td>9582.574138</td>
      <td>10666.935714</td>
      <td>10241.400000</td>
      <td>10216.250000</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>10976.020</td>
      <td>11099.055000</td>
      <td>11640.600000</td>
      <td>11881.532143</td>
      <td>13249.775000</td>
    </tr>
    <tr>
      <th>전남</th>
      <td>6798.880</td>
      <td>6936.600000</td>
      <td>7372.920000</td>
      <td>7929.845000</td>
      <td>8219.275862</td>
    </tr>
    <tr>
      <th>전북</th>
      <td>7110.400</td>
      <td>6906.625000</td>
      <td>7398.973585</td>
      <td>8174.595000</td>
      <td>8532.260000</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>7951.075</td>
      <td>9567.480000</td>
      <td>12566.730000</td>
      <td>11935.968000</td>
      <td>11828.469231</td>
    </tr>
    <tr>
      <th>충남</th>
      <td>7689.880</td>
      <td>7958.225000</td>
      <td>8198.422222</td>
      <td>8201.820000</td>
      <td>8748.840000</td>
    </tr>
    <tr>
      <th>충북</th>
      <td>6828.800</td>
      <td>7133.335000</td>
      <td>7473.120000</td>
      <td>8149.295000</td>
      <td>7970.875000</td>
    </tr>
  </tbody>
</table>
</div>

## pivot table 로 데이터 집계하기

* groupby 로 했던 작업을 pivot_table로 똑같이 해봅니다.
* pivot()은 연산을 하지 않고 데이터의 형태만 바꿔주어서 agg function이 없음
* pivot_table()은 agg function 있음

```python
pd.pivot_table(df_last, index=["지역명"], values=["평당분양가격"], aggfunc="mean")
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평당분양가격</th>
    </tr>
    <tr>
      <th>지역명</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강원</th>
      <td>7890.750000</td>
    </tr>
    <tr>
      <th>경기</th>
      <td>13356.895200</td>
    </tr>
    <tr>
      <th>경남</th>
      <td>9268.778138</td>
    </tr>
    <tr>
      <th>경북</th>
      <td>8376.536515</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>9951.535821</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>11980.895455</td>
    </tr>
    <tr>
      <th>대전</th>
      <td>10253.333333</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>12087.121200</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>23599.976400</td>
    </tr>
    <tr>
      <th>세종</th>
      <td>9796.516456</td>
    </tr>
    <tr>
      <th>울산</th>
      <td>10014.902013</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>11915.320732</td>
    </tr>
    <tr>
      <th>전남</th>
      <td>7565.316532</td>
    </tr>
    <tr>
      <th>전북</th>
      <td>7724.235484</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>11241.276712</td>
    </tr>
    <tr>
      <th>충남</th>
      <td>8233.651883</td>
    </tr>
    <tr>
      <th>충북</th>
      <td>7634.655600</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_last.groupby(["전용면적"])["평당분양가격"].mean()
```

```python
# default agg func은 mean()
pd.pivot_table(df_last, index="전용면적", values="평당분양가격")
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평당분양가격</th>
    </tr>
    <tr>
      <th>전용면적</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>102㎡~</th>
      <td>11517.705634</td>
    </tr>
    <tr>
      <th>60㎡</th>
      <td>10375.137421</td>
    </tr>
    <tr>
      <th>60㎡~85㎡</th>
      <td>10271.040071</td>
    </tr>
    <tr>
      <th>85㎡~102㎡</th>
      <td>11097.599573</td>
    </tr>
    <tr>
      <th>전체</th>
      <td>10276.086207</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 지역명, 전용면적으로 평당분양가격의 평균을 구합니다.
# df_last.groupby(["전용면적", "지역명"])["평당분양가격"].mean().unstack().round()
```

```python
df_last.pivot_table(index="전용면적", columns="지역명", values="평당분양가격").round()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>지역명</th>
      <th>강원</th>
      <th>경기</th>
      <th>경남</th>
      <th>경북</th>
      <th>광주</th>
      <th>대구</th>
      <th>대전</th>
      <th>부산</th>
      <th>서울</th>
      <th>세종</th>
      <th>울산</th>
      <th>인천</th>
      <th>전남</th>
      <th>전북</th>
      <th>제주</th>
      <th>충남</th>
      <th>충북</th>
    </tr>
    <tr>
      <th>전용면적</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>102㎡~</th>
      <td>8311.0</td>
      <td>14772.0</td>
      <td>10358.0</td>
      <td>9157.0</td>
      <td>11042.0</td>
      <td>13087.0</td>
      <td>14877.0</td>
      <td>13208.0</td>
      <td>23446.0</td>
      <td>10107.0</td>
      <td>9974.0</td>
      <td>14362.0</td>
      <td>8168.0</td>
      <td>8194.0</td>
      <td>10523.0</td>
      <td>8689.0</td>
      <td>8195.0</td>
    </tr>
    <tr>
      <th>60㎡</th>
      <td>7567.0</td>
      <td>13252.0</td>
      <td>8689.0</td>
      <td>7883.0</td>
      <td>9431.0</td>
      <td>11992.0</td>
      <td>9176.0</td>
      <td>11354.0</td>
      <td>23213.0</td>
      <td>9324.0</td>
      <td>9202.0</td>
      <td>11241.0</td>
      <td>7210.0</td>
      <td>7610.0</td>
      <td>14022.0</td>
      <td>7911.0</td>
      <td>7103.0</td>
    </tr>
    <tr>
      <th>60㎡~85㎡</th>
      <td>7486.0</td>
      <td>12524.0</td>
      <td>8619.0</td>
      <td>8061.0</td>
      <td>9911.0</td>
      <td>11779.0</td>
      <td>9711.0</td>
      <td>11865.0</td>
      <td>22787.0</td>
      <td>9775.0</td>
      <td>10503.0</td>
      <td>11384.0</td>
      <td>7269.0</td>
      <td>7271.0</td>
      <td>10621.0</td>
      <td>7819.0</td>
      <td>7264.0</td>
    </tr>
    <tr>
      <th>85㎡~102㎡</th>
      <td>8750.0</td>
      <td>13678.0</td>
      <td>10018.0</td>
      <td>8774.0</td>
      <td>9296.0</td>
      <td>11141.0</td>
      <td>9037.0</td>
      <td>12073.0</td>
      <td>25944.0</td>
      <td>9848.0</td>
      <td>8861.0</td>
      <td>11528.0</td>
      <td>7909.0</td>
      <td>8276.0</td>
      <td>10709.0</td>
      <td>9120.0</td>
      <td>8391.0</td>
    </tr>
    <tr>
      <th>전체</th>
      <td>7478.0</td>
      <td>12560.0</td>
      <td>8659.0</td>
      <td>8079.0</td>
      <td>9904.0</td>
      <td>11771.0</td>
      <td>9786.0</td>
      <td>11936.0</td>
      <td>22610.0</td>
      <td>9805.0</td>
      <td>10493.0</td>
      <td>11257.0</td>
      <td>7284.0</td>
      <td>7293.0</td>
      <td>10785.0</td>
      <td>7815.0</td>
      <td>7219.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 연도, 지역명으로 평당분양가격의 평균을 구합니다.
# g = df_last.groupby(["연도", "지역명"])["평당분양가격"].mean()
p = pd.pivot_table(df_last, index=["연도", "지역명"], values="평당분양가격")
p
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>평당분양가격</th>
    </tr>
    <tr>
      <th>연도</th>
      <th>지역명</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2015</th>
      <th>강원</th>
      <td>7188.060000</td>
    </tr>
    <tr>
      <th>경기</th>
      <td>11060.940000</td>
    </tr>
    <tr>
      <th>경남</th>
      <td>8459.220000</td>
    </tr>
    <tr>
      <th>경북</th>
      <td>7464.160000</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>7916.700000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2019</th>
      <th>전남</th>
      <td>8219.275862</td>
    </tr>
    <tr>
      <th>전북</th>
      <td>8532.260000</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>11828.469231</td>
    </tr>
    <tr>
      <th>충남</th>
      <td>8748.840000</td>
    </tr>
    <tr>
      <th>충북</th>
      <td>7970.875000</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 1 columns</p>
</div>

```python
p.loc[2017]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평당분양가격</th>
    </tr>
    <tr>
      <th>지역명</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강원</th>
      <td>7273.560000</td>
    </tr>
    <tr>
      <th>경기</th>
      <td>12304.980000</td>
    </tr>
    <tr>
      <th>경남</th>
      <td>8786.760000</td>
    </tr>
    <tr>
      <th>경북</th>
      <td>8280.800000</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>9613.977551</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>12206.700000</td>
    </tr>
    <tr>
      <th>대전</th>
      <td>9957.158491</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>11560.680000</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>21831.060000</td>
    </tr>
    <tr>
      <th>세종</th>
      <td>9132.505556</td>
    </tr>
    <tr>
      <th>울산</th>
      <td>10666.935714</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>11640.600000</td>
    </tr>
    <tr>
      <th>전남</th>
      <td>7372.920000</td>
    </tr>
    <tr>
      <th>전북</th>
      <td>7398.973585</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>12566.730000</td>
    </tr>
    <tr>
      <th>충남</th>
      <td>8198.422222</td>
    </tr>
    <tr>
      <th>충북</th>
      <td>7473.120000</td>
    </tr>
  </tbody>
</table>
</div>

## 최근 데이터 시각화 하기

### 데이터시각화를 위한 폰트설정

한글폰트 사용을 위해 matplotlib의 pyplot을 plt라는 별칭으로 불러옵니다.

```python
import matplotlib.pyplot as plt

# plt.rc("font", family="Malgun Gothic")
plt.rc("font", family="AppleGothic")
```

```python
# 폰트 설정이 잘 안 된다면 해당 셀의 마지막 줄 주석을 풀고 실행해 보세요.
# colab 사용시에도 아래 함수를 활용해 보세요.
def get_font_family():
    """
    시스템 환경에 따른 기본 폰트명을 반환하는 함수
    """
    import platform
    system_name = platform.system()

    if system_name == "Darwin" :
        font_family = "AppleGothic"
    elif system_name == "Windows":
        font_family = "Malgun Gothic"
    else:
        # Linux(colab)
        !apt-get install fonts-nanum -qq  > /dev/null
        !fc-cache -fv

        import matplotlib as mpl
        mpl.font_manager._rebuild()
        findfont = mpl.font_manager.fontManager.findfont
        mpl.font_manager.findfont = findfont
        mpl.backends.backend_agg.findfont = findfont
        
        font_family = "NanumBarunGothic"
    return font_family

# plt.rc("font", family=get_font_family())
```

### Pandas로 시각화 하기 - 선그래프와 막대그래프

pandas의 plot을 활용하면 다양한 그래프를 그릴 수 있습니다.

seaborn을 사용했을 때보다 pandas를 사용해서 시각화를 할 때의 장점은 미리 계산을 하고 그리기 때문에 속도가 좀 더 빠릅니다.

```python
# 지역명으로 분양가격의 평균을 구하고 선그래프로 시각화 합니다.
g = df_last.groupby(["지역명"])["평당분양가격"].mean().sort_values(ascending=False)
g.plot()
```

<img width="858" alt="apt_price_1" src="https://github.com/zacinthepark/TIL/assets/86648892/f23e3e2b-2e46-46b8-9aa4-5de208ee0f78">

```python
# 지역명으로 분양가격의 평균을 구하고 막대그래프(bar)로 시각화 합니다.
g.plot.bar(rot=0, figsize=(10, 3))
```

<img width="854" alt="apt_price_2" src="https://github.com/zacinthepark/TIL/assets/86648892/497a425d-0106-4671-99e0-7a3152dfee83">

전용면적별 분양가격의 평균값을 구하고 그래프로 그려봅니다.

```python
# 전용면적으로 분양가격의 평균을 구하고 막대그래프(bar)로 시각화 합니다.
df_last.groupby(["전용면적"])["평당분양가격"].mean().plot.bar(rot=0)
```

<img width="857" alt="apt_price_3" src="https://github.com/zacinthepark/TIL/assets/86648892/9755f45b-90f2-4768-b14d-0194420713b5">

```python
# 연도별 분양가격의 평균을 구하고 막대그래프(bar)로 시각화 합니다.
# 연도에 소숫점이 생기지 않게 표시하고자 한다면 ax.xaxis.set_major_locator를 사용해서 integer로 설정합니다.
from matplotlib.ticker import MaxNLocator

ax = plt.figure().gca()
df_last.groupby(["연도"])["평당분양가격"].mean().plot()
ax.xaxis.set_major_locator(MaxNLocator(integer=True))
```

<img width="850" alt="apt_price_4" src="https://github.com/zacinthepark/TIL/assets/86648892/5ab6b835-5406-4a09-ad92-a2b744c7f508">

### box-and-whisker plot | diagram

* https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html
* https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.boxplot.html
* [상자 수염 그림 - 위키백과, 우리 모두의 백과사전](https://ko.wikipedia.org/wiki/%EC%83%81%EC%9E%90_%EC%88%98%EC%97%BC_%EA%B7%B8%EB%A6%BC)
* 가공하지 않은 자료 그대로를 이용하여 그린 것이 아니라, 자료로부터 얻어낸 통계량인 5가지 요약 수치로 그린다.

* 5가지 요약 수치란 기술통계학에서 자료의 정보를 알려주는 아래의 다섯 가지 수치를 의미한다.

1. 최솟값
2. 제 1사분위수
3. 제 2사분위수( ), 즉 중앙값
4. 제 3 사분위 수( )
5. 최댓값

* Box plot 이해하기 : 
    * [박스 플롯에 대하여 :: -[|]- Box and Whisker](https://boxnwhis.kr/2019/02/19/boxplot.html)
    * [Understanding Boxplots – Towards Data Science](https://towardsdatascience.com/understanding-boxplots-5e2df7bcbd51)

```python
df_last.pivot_table(index="월", columns="연도", values="평당분양가격")
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>연도</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>월</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>9334.029630</td>
      <td>10095.132143</td>
      <td>10719.148000</td>
      <td>11535.540789</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>9361.440000</td>
      <td>10110.885714</td>
      <td>10766.668000</td>
      <td>11574.793421</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>9423.276923</td>
      <td>10107.428571</td>
      <td>10905.488000</td>
      <td>11610.094737</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>9601.993902</td>
      <td>10217.232143</td>
      <td>10920.728571</td>
      <td>11777.876000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>9602.396341</td>
      <td>10358.819277</td>
      <td>11087.485714</td>
      <td>11976.394737</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>9676.042683</td>
      <td>10431.618072</td>
      <td>10921.928571</td>
      <td>12401.884000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>9700.551220</td>
      <td>10549.536585</td>
      <td>10868.376316</td>
      <td>12424.852000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>9719.023171</td>
      <td>10564.869512</td>
      <td>10811.147368</td>
      <td>12523.896000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>9737.656098</td>
      <td>10583.601266</td>
      <td>10915.257692</td>
      <td>12527.571429</td>
    </tr>
    <tr>
      <th>10</th>
      <td>9086.488889</td>
      <td>9924.225882</td>
      <td>10399.845570</td>
      <td>11133.269231</td>
      <td>12619.073077</td>
    </tr>
    <tr>
      <th>11</th>
      <td>9218.122222</td>
      <td>9972.757143</td>
      <td>NaN</td>
      <td>11224.762025</td>
      <td>12647.785714</td>
    </tr>
    <tr>
      <th>12</th>
      <td>9303.596296</td>
      <td>10092.264286</td>
      <td>10597.620000</td>
      <td>11453.822368</td>
      <td>12622.847368</td>
    </tr>
  </tbody>
</table>
</div>

```python
df_last.pivot_table(index="월", columns="연도", values="평당분양가격").plot.box()
```

<img width="854" alt="apt_price_5" src="https://github.com/zacinthepark/TIL/assets/86648892/56dcd9c2-eb10-4144-aece-a22441fdfee5">

```python
p = df_last.pivot_table(index="월", columns=["연도", "전용면적"], values="평당분양가격")
p.plot.box(figsize=(15, 3), rot=30)
```

<img width="855" alt="apt_price_6" src="https://github.com/zacinthepark/TIL/assets/86648892/ca05de79-681d-43e3-bc85-84367aae30ec">

```python
p = df_last.pivot_table(index="연도", columns="지역명", values="평당분양가격")
p.plot(figsize=(15, 3), rot=30)
# 그래프의 밖에 legend 표시하도록 설정
plt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)
```

<img width="857" alt="apt_price_7" src="https://github.com/zacinthepark/TIL/assets/86648892/a54e48b3-612e-432c-a325-e2da24527835">

### Seaborn 으로 시각화 해보기

```python
import seaborn as sns
%matplotlib inline
```

```python
# barplot으로 지역별 평당분양가격을 그려봅니다.
# ci는 confidence interval, 신뢰구간으로 기본값은 95로 95% 신뢰구간 데이터만 보여주는 것
plt.figure(figsize=(10, 3))
sns.barplot(data=df_last, x="지역명", y="평당분양가격", ci=None)
```

<img width="857" alt="apt_price_8" src="https://github.com/zacinthepark/TIL/assets/86648892/dae62e50-d390-4693-8862-cd1193ca70f9">

```python
# barplot으로 연도별 평당분양가격을 그려봅니다.

sns.barplot(data=df_last, x="연도", y="평당분양가격")
```

<img width="859" alt="apt_price_9" src="https://github.com/zacinthepark/TIL/assets/86648892/4caefca1-538d-42f2-87bd-c2b2ae3a24b6">

```python
sns.catplot(data=df_last, x="연도", y="평당분양가격", kind="bar", col="지역명", col_wrap=4)
```

<img width="861" alt="apt_price_10" src="https://github.com/zacinthepark/TIL/assets/86648892/1923d950-8986-4977-9c0a-8240d67df096">

https://stackoverflow.com/questions/30490740/move-legend-outside-figure-in-seaborn-tsplot

```python
# lineplot으로 연도별 평당분양가격을 그려봅니다.
# hue 옵션을 통해 지역별로 다르게 표시해 봅니다.
plt.figure(figsize=(10, 5))
sns.lineplot(data=df_last, x="연도", y="평당분양가격", hue="지역명")
plt.legend(bbox_to_anchor=(1.02, 1), loc=2, borderaxespad=0.)
```

<img width="856" alt="apt_price_11" src="https://github.com/zacinthepark/TIL/assets/86648892/dea44d5c-6b0b-4ba9-8338-0d1d51a907c1">

```python
sns.relplot(data=df_last, x="연도", y="평당분양가격", 
            hue="지역명", kind="line", col="지역명", col_wrap=4, ci=None)
```

<img width="860" alt="apt_price_12" src="https://github.com/zacinthepark/TIL/assets/86648892/f1006b77-8f3b-4686-9540-f8796613b000">

### boxplot과 violinplot

```python
# 연도별 평당분양가격을 boxplot으로 그려봅니다.
# 최솟값
# 제 1사분위수
# 제 2사분위수( ), 즉 중앙값
# 제 3 사분위 수( )
# 최댓값

sns.boxplot(data=df_last, x="연도", y="평당분양가격")
```

<img width="852" alt="apt_price_13" src="https://github.com/zacinthepark/TIL/assets/86648892/b8cbcbdc-2b99-438b-9e49-5db7e441fe12">

```python
# hue옵션을 주어 전용면적별로 다르게 표시해 봅니다.
plt.figure(figsize=(12, 3))
sns.boxplot(data=df_last, x="연도", y="평당분양가격", hue="전용면적")
```

<img width="856" alt="apt_price_14" src="https://github.com/zacinthepark/TIL/assets/86648892/9d378029-acae-4b39-95f3-fb1141209688">

https://www.research.autodesk.com/publications/same-stats-different-graphs/

```python
# 연도별 평당분양가격을 violinplot으로 그려봅니다.
# boxplot에서 확인하기 힘든 값의 분포를 알기 편함
# 밀도추정그래프를 세로로 세워놓은 모양

sns.violinplot(data=df_last, x="연도", y="평당분양가격")
```

<img width="852" alt="apt_price_15" src="https://github.com/zacinthepark/TIL/assets/86648892/0cd936a5-15b1-40a9-ace0-180fc4bb2689">

### lmplot과 swarmplot 

```python
df_last["연도"].unique()
```

<pre>
array([2015, 2016, 2017, 2018, 2019])
</pre>

```python
sns.regplot(data=df_last, x="연도", y="평당분양가격")
```

<img width="855" alt="apt_price_16" src="https://github.com/zacinthepark/TIL/assets/86648892/547674b5-5152-4449-8cd4-0618ae7b08b6">

```python
sns.regplot(data=df_last, x="연도", y="평당분양가격", x_jitter=.1)
```

<img width="858" alt="apt_price_17" src="https://github.com/zacinthepark/TIL/assets/86648892/bac962c5-4ee2-4dd6-9304-0673de894f04">

```python
# 연도별 평당분양가격을 lmplot으로 그려봅니다. 
# hue 옵션으로 전용면적을 표현해 봅니다.
sns.lmplot(data=df_last, x="연도", y="평당분양가격", hue="전용면적", col="전용면적", col_wrap=3,  x_jitter=.1)
```

<img width="860" alt="apt_price_18" src="https://github.com/zacinthepark/TIL/assets/86648892/906ea085-ca7a-4581-9cae-81c11767f18d">

```python
# 연도별 평당분양가격을 swarmplot 으로 그려봅니다. 
# swarmplot은 범주형(카테고리) 데이터의 산점도를 표현하기에 적합합니다.
plt.figure(figsize=(15, 3))
sns.swarmplot(data=df_last, x="연도", y="평당분양가격", hue="전용면적", size=1)
```

<img width="896" alt="apt_price_19" src="https://github.com/zacinthepark/TIL/assets/86648892/cce8e29c-836e-4775-aa9d-9e74687f352e">

### 이상치 보기

```python
# 평당분양가격의 최대값을 구해서 max_price 라는 변수에 담습니다.

df_last["평당분양가격"].describe()
```

<pre>
count     3957.000000
mean     10685.824488
std       4172.222780
min       6164.400000
25%       8055.300000
50%       9484.200000
75%      11751.300000
max      42002.400000
Name: 평당분양가격, dtype: float64
</pre>

```python
max_price = df_last["평당분양가격"].max()
max_price
```

<pre>
42002.399999999994
</pre>

```python
# 서울의 평당분양가격이 특히 높은 데이터가 있습니다. 해당 데이터를 가져옵니다.
df_last[df_last["평당분양가격"] == max_price]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격</th>
      <th>평당분양가격</th>
      <th>전용면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3743</th>
      <td>서울</td>
      <td>2019</td>
      <td>6</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>3828</th>
      <td>서울</td>
      <td>2019</td>
      <td>7</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>3913</th>
      <td>서울</td>
      <td>2019</td>
      <td>8</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>3998</th>
      <td>서울</td>
      <td>2019</td>
      <td>9</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>4083</th>
      <td>서울</td>
      <td>2019</td>
      <td>10</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>4168</th>
      <td>서울</td>
      <td>2019</td>
      <td>11</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>4253</th>
      <td>서울</td>
      <td>2019</td>
      <td>12</td>
      <td>12728.0</td>
      <td>42002.4</td>
      <td>85㎡~102㎡</td>
    </tr>
  </tbody>
</table>
</div>


### 수치데이터 히스토그램 그리기


distplot은 결측치가 있으면 그래프를 그릴 때 오류가 납니다.

따라서 결측치가 아닌 데이터만 따로 모아서 평당분양가격을 시각화하기 위한 데이터를 만듭니다.

데이터프레임의 .loc를 활용하여 결측치가 없는 데이터에서 평당분양가격만 가져옵니다.

```python
h = df_last["평당분양가격"].hist(bins=10)
```

<img width="865" alt="apt_price_20" src="https://github.com/zacinthepark/TIL/assets/86648892/768ea5a2-afbb-4ef5-b009-830d3398ad77">

```python
# 결측치가 없는 데이터에서 평당분양가격만 가져옵니다. 그리고 price라는 변수에 담습니다.
# .loc[행]
# .loc[행, 열]
price = df_last.loc[df_last["평당분양가격"].notnull(), "평당분양가격"]
```

```python
# distplot으로 평당분양가격을 표현해 봅니다.

sns.distplot(price)
```

<img width="879" alt="apt_price_21" src="https://github.com/zacinthepark/TIL/assets/86648892/84f6d139-d5e9-4d3b-91c3-941380767c6b">

```python
# sns.distplot(price, hist=False, rug=True)
sns.kdeplot(price, shade=True)
sns.rugplot(price)
```

<img width="856" alt="apt_price_22" src="https://github.com/zacinthepark/TIL/assets/86648892/2cccb51c-a5ee-4ea5-80a4-56ba1757c349">


```python
sns.displot(price, kde=True, rug=True)
```

<img width="858" alt="apt_price_23" src="https://github.com/zacinthepark/TIL/assets/86648892/498f5e80-325d-440d-b818-b44541f1e4bf">


```python
sns.displot(data=df_last, x="평당분양가격", kde=True, rug=True, hue="전용면적")
```

<img width="852" alt="apt_price_24" src="https://github.com/zacinthepark/TIL/assets/86648892/6ead47bd-3a01-4c14-99dc-fcf4c397b416">

```python
sns.displot(data=df_last, x="평당분양가격", kde=True, rug=True, hue="전용면적", col="전용면적", col_wrap=3)
```

<img width="861" alt="apt_price_25" src="https://github.com/zacinthepark/TIL/assets/86648892/864fc7e4-2f2e-4c1e-9a63-8c10d6381ab7">

```python
sns.displot(data=df_last, x="평당분양가격", kde=True, rug=True,
            hue="지역명", col="지역명", col_wrap=1, aspect=5, height=1)
```

<img width="888" alt="apt_price_26" src="https://github.com/zacinthepark/TIL/assets/86648892/0d2a7391-f839-4ccb-be3c-e9c69a988882">

* distplot을 산마루 형태의 ridge plot으로 그리기
* https://seaborn.pydata.org/tutorial/axis_grids.html#conditional-small-multiples
* https://seaborn.pydata.org/examples/kde_ridgeplot.html

```python
# subplot 으로 표현해 봅니다.
g = sns.FacetGrid(df_last, row="지역명",
                  height=1.7, aspect=4,)
g.map(sns.kdeplot, "평당분양가격");
```

<img width="886" alt="apt_price_27" src="https://github.com/zacinthepark/TIL/assets/86648892/eaf65e6b-c2e5-4dd2-9731-ef016d7cb678">

```python
# pairplot
df_last_notnull = df_last.loc[df_last["평당분양가격"].notnull(), 
                          ["연도", "월", "평당분양가격", "지역명", "전용면적"]]
sns.pairplot(df_last_notnull, hue="지역명")
```

<img width="858" alt="apt_price_28" src="https://github.com/zacinthepark/TIL/assets/86648892/24d0a013-0256-4b09-8621-505009eb935d">

```python
# 규모구분(전용면적)별로 value_counts를 사용해서 데이터를 집계해 봅니다.
df_last["전용면적"].value_counts()
```

<pre>
전용면적
전체          867
60㎡         867
60㎡~85㎡     867
85㎡~102㎡    867
102㎡~       867
Name: count, dtype: int64
</pre>

## 2015년 8월 이전 데이터 보기

```python
pd.options.display.max_columns = 25
```


```python
df_last.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격</th>
      <th>평당분양가격</th>
      <th>전용면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5841.0</td>
      <td>19275.3</td>
      <td>전체</td>
    </tr>
    <tr>
      <th>1</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5652.0</td>
      <td>18651.6</td>
      <td>60㎡</td>
    </tr>
    <tr>
      <th>2</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5882.0</td>
      <td>19410.6</td>
      <td>60㎡~85㎡</td>
    </tr>
    <tr>
      <th>3</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5721.0</td>
      <td>18879.3</td>
      <td>85㎡~102㎡</td>
    </tr>
    <tr>
      <th>4</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>5879.0</td>
      <td>19400.7</td>
      <td>102㎡~</td>
    </tr>
  </tbody>
</table>
</div>

```python
df_first.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>2013년12월</th>
      <th>2014년1월</th>
      <th>2014년2월</th>
      <th>2014년3월</th>
      <th>2014년4월</th>
      <th>2014년5월</th>
      <th>2014년6월</th>
      <th>2014년7월</th>
      <th>2014년8월</th>
      <th>2014년9월</th>
      <th>2014년10월</th>
      <th>2014년11월</th>
      <th>2014년12월</th>
      <th>2015년1월</th>
      <th>2015년2월</th>
      <th>2015년3월</th>
      <th>2015년4월</th>
      <th>2015년5월</th>
      <th>2015년6월</th>
      <th>2015년7월</th>
      <th>2015년8월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>18189</td>
      <td>17925</td>
      <td>17925</td>
      <td>18016</td>
      <td>18098</td>
      <td>19446</td>
      <td>18867</td>
      <td>18742</td>
      <td>19274</td>
      <td>19404</td>
      <td>19759</td>
      <td>20242</td>
      <td>20269</td>
      <td>20670</td>
      <td>20670</td>
      <td>19415</td>
      <td>18842</td>
      <td>18367</td>
      <td>18374</td>
      <td>18152</td>
      <td>18443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>부산</td>
      <td>8111</td>
      <td>8111</td>
      <td>9078</td>
      <td>8965</td>
      <td>9402</td>
      <td>9501</td>
      <td>9453</td>
      <td>9457</td>
      <td>9411</td>
      <td>9258</td>
      <td>9110</td>
      <td>9208</td>
      <td>9208</td>
      <td>9204</td>
      <td>9235</td>
      <td>9279</td>
      <td>9327</td>
      <td>9345</td>
      <td>9515</td>
      <td>9559</td>
      <td>9581</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구</td>
      <td>8080</td>
      <td>8080</td>
      <td>8077</td>
      <td>8101</td>
      <td>8267</td>
      <td>8274</td>
      <td>8360</td>
      <td>8360</td>
      <td>8370</td>
      <td>8449</td>
      <td>8403</td>
      <td>8439</td>
      <td>8253</td>
      <td>8327</td>
      <td>8416</td>
      <td>8441</td>
      <td>8446</td>
      <td>8568</td>
      <td>8542</td>
      <td>8542</td>
      <td>8795</td>
    </tr>
    <tr>
      <th>3</th>
      <td>인천</td>
      <td>10204</td>
      <td>10204</td>
      <td>10408</td>
      <td>10408</td>
      <td>10000</td>
      <td>9844</td>
      <td>10058</td>
      <td>9974</td>
      <td>9973</td>
      <td>9973</td>
      <td>10016</td>
      <td>10020</td>
      <td>10020</td>
      <td>10017</td>
      <td>9876</td>
      <td>9876</td>
      <td>9938</td>
      <td>10551</td>
      <td>10443</td>
      <td>10443</td>
      <td>10449</td>
    </tr>
    <tr>
      <th>4</th>
      <td>광주</td>
      <td>6098</td>
      <td>7326</td>
      <td>7611</td>
      <td>7346</td>
      <td>7346</td>
      <td>7523</td>
      <td>7659</td>
      <td>7612</td>
      <td>7622</td>
      <td>7802</td>
      <td>7707</td>
      <td>7752</td>
      <td>7748</td>
      <td>7752</td>
      <td>7756</td>
      <td>7861</td>
      <td>7914</td>
      <td>7877</td>
      <td>7881</td>
      <td>8089</td>
      <td>8231</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_first 변수에 담겨있는 데이터프레임의 정보를 info를 통해 봅니다.
df_first.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 17 entries, 0 to 16
Data columns (total 22 columns):
 #   Column    Non-Null Count  Dtype 
---  ------    --------------  ----- 
 0   지역        17 non-null     object
 1   2013년12월  17 non-null     int64 
 2   2014년1월   17 non-null     int64 
 3   2014년2월   17 non-null     int64 
 4   2014년3월   17 non-null     int64 
 5   2014년4월   17 non-null     int64 
 6   2014년5월   17 non-null     int64 
 7   2014년6월   17 non-null     int64 
 8   2014년7월   17 non-null     int64 
 9   2014년8월   17 non-null     int64 
 10  2014년9월   17 non-null     int64 
 11  2014년10월  17 non-null     int64 
 12  2014년11월  17 non-null     int64 
 13  2014년12월  17 non-null     int64 
 14  2015년1월   17 non-null     int64 
 15  2015년2월   17 non-null     int64 
 16  2015년3월   17 non-null     int64 
 17  2015년4월   17 non-null     int64 
 18  2015년5월   17 non-null     int64 
 19  2015년6월   17 non-null     int64 
 20  2015년7월   17 non-null     int64 
 21  2015년8월   17 non-null     int64 
dtypes: int64(21), object(1)
memory usage: 3.1+ KB
</pre>

```python
# 결측치가 있는지 봅니다.
df_first.isnull().sum()
```

<pre>
지역          0
2013년12월    0
2014년1월     0
2014년2월     0
2014년3월     0
2014년4월     0
2014년5월     0
2014년6월     0
2014년7월     0
2014년8월     0
2014년9월     0
2014년10월    0
2014년11월    0
2014년12월    0
2015년1월     0
2015년2월     0
2015년3월     0
2015년4월     0
2015년5월     0
2015년6월     0
2015년7월     0
2015년8월     0
dtype: int64
</pre>

### melt로 Tidy data 만들기

pandas의 melt를 사용하면 데이터의 형태를 변경할 수 있습니다. 

df_first 변수에 담긴 데이터프레임은 df_last에 담겨있는 데이터프레임의 모습과 다릅니다. 

같은 형태로 만들어주어야 데이터를 합칠 수 있습니다. 

데이터를 병합하기 위해 melt를 사용해 열에 있는 데이터를 행으로 녹여봅니다.

* https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-melt
* [Tidy Data 란?](https://vita.had.co.nz/papers/tidy-data.pdf)

```python
df_first.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>2013년12월</th>
      <th>2014년1월</th>
      <th>2014년2월</th>
      <th>2014년3월</th>
      <th>2014년4월</th>
      <th>2014년5월</th>
      <th>2014년6월</th>
      <th>2014년7월</th>
      <th>2014년8월</th>
      <th>2014년9월</th>
      <th>2014년10월</th>
      <th>2014년11월</th>
      <th>2014년12월</th>
      <th>2015년1월</th>
      <th>2015년2월</th>
      <th>2015년3월</th>
      <th>2015년4월</th>
      <th>2015년5월</th>
      <th>2015년6월</th>
      <th>2015년7월</th>
      <th>2015년8월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>18189</td>
      <td>17925</td>
      <td>17925</td>
      <td>18016</td>
      <td>18098</td>
      <td>19446</td>
      <td>18867</td>
      <td>18742</td>
      <td>19274</td>
      <td>19404</td>
      <td>19759</td>
      <td>20242</td>
      <td>20269</td>
      <td>20670</td>
      <td>20670</td>
      <td>19415</td>
      <td>18842</td>
      <td>18367</td>
      <td>18374</td>
      <td>18152</td>
      <td>18443</td>
    </tr>
  </tbody>
</table>
</div>

```python
df_first.melt(id_vars="지역", var_name="기간", value_name="평당분양가격")
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>기간</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013년12월</td>
      <td>18189</td>
    </tr>
    <tr>
      <th>1</th>
      <td>부산</td>
      <td>2013년12월</td>
      <td>8111</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구</td>
      <td>2013년12월</td>
      <td>8080</td>
    </tr>
    <tr>
      <th>3</th>
      <td>인천</td>
      <td>2013년12월</td>
      <td>10204</td>
    </tr>
    <tr>
      <th>4</th>
      <td>광주</td>
      <td>2013년12월</td>
      <td>6098</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>352</th>
      <td>전북</td>
      <td>2015년8월</td>
      <td>6580</td>
    </tr>
    <tr>
      <th>353</th>
      <td>전남</td>
      <td>2015년8월</td>
      <td>6289</td>
    </tr>
    <tr>
      <th>354</th>
      <td>경북</td>
      <td>2015년8월</td>
      <td>7037</td>
    </tr>
    <tr>
      <th>355</th>
      <td>경남</td>
      <td>2015년8월</td>
      <td>7665</td>
    </tr>
    <tr>
      <th>356</th>
      <td>제주</td>
      <td>2015년8월</td>
      <td>7343</td>
    </tr>
  </tbody>
</table>
<p>357 rows × 3 columns</p>
</div>

```python
# pd.melt 를 사용하며, 녹인 데이터는 df_first_melt 변수에 담습니다. 

df_first_melt = df_first.melt(id_vars="지역", var_name="기간", value_name="평당분양가격")
df_first_melt.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역</th>
      <th>기간</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013년12월</td>
      <td>18189</td>
    </tr>
    <tr>
      <th>1</th>
      <td>부산</td>
      <td>2013년12월</td>
      <td>8111</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구</td>
      <td>2013년12월</td>
      <td>8080</td>
    </tr>
    <tr>
      <th>3</th>
      <td>인천</td>
      <td>2013년12월</td>
      <td>10204</td>
    </tr>
    <tr>
      <th>4</th>
      <td>광주</td>
      <td>2013년12월</td>
      <td>6098</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_first_melt 변수에 담겨진 컬럼의 이름을 
# ["지역명", "기간", "평당분양가격"] 으로 변경합니다.

df_first_melt.columns = ["지역명", "기간", "평당분양가격"]
df_first_melt.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>기간</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013년12월</td>
      <td>18189</td>
    </tr>
  </tbody>
</table>
</div>

### 연도와 월을 분리하기

* pandas 의 string-handling 사용하기 : https://pandas.pydata.org/pandas-docs/stable/reference/series.html#string-handling

```python
date = "2013년12월"
date
```

<pre>
'2013년12월'
</pre>

```python
# split 을 통해 "년"을 기준으로 텍스트를 분리해 봅니다.
date.split("년")
```

<pre>
['2013', '12월']
</pre>

```python
# 리스트의 인덱싱을 사용해서 연도만 가져옵니다.
date.split("년")[0]
```

<pre>
'2013'
</pre>

```python
# 리스트의 인덱싱과 replace를 사용해서 월을 제거합니다.

date.split("년")[-1].replace("월", "")
```

<pre>
'12'
</pre>

```python
# parse_year라는 함수를 만듭니다.
# 연도만 반환하도록 하며, 반환하는 데이터는 int 타입이 되도록 합니다.

def parse_year(date):
    year = date.split("년")[0]
    year = int(year)
    return year

y = parse_year(date)
print(type(y))
y
```

<pre>
<class 'int'>
</pre>
<pre>
2013
</pre>

```python
# 제대로 분리가 되었는지 parse_year 함수를 확인합니다.
parse_year(date)
```

<pre>
2013
</pre>

```python
# parse_month 라는 함수를 만듭니다.
# 월만 반환하도록 하며, 반환하는 데이터는 int 타입이 되도록 합니다.
def parse_month(date):
    month = date.split("년")[-1].replace("월", "")
    month = int(month)
    return month
```

```python
# 제대로 분리가 되었는지 parse_month 함수를 확인합니다.
parse_month(date)
```

<pre>
12
</pre>

```python
# df_first_melt 변수에 담긴 데이터프레임에서 
# apply를 활용해 연도만 추출해서 새로운 컬럼에 담습니다.

df_first_melt["연도"] = df_first_melt["기간"].apply(parse_year)
df_first_melt.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>기간</th>
      <th>평당분양가격</th>
      <th>연도</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013년12월</td>
      <td>18189</td>
      <td>2013</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_first_melt 변수에 담긴 데이터프레임에서 
# apply를 활용해 월만 추출해서 새로운 컬럼에 담습니다.

df_first_melt["월"] = df_first_melt["기간"].apply(parse_month)
df_first_melt.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>기간</th>
      <th>평당분양가격</th>
      <th>연도</th>
      <th>월</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013년12월</td>
      <td>18189</td>
      <td>2013</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_last와 병합을 하기 위해서는 컬럼의 이름이 같아야 합니다.
# sample을 활용해서 데이터를 미리보기 합니다.
df_last.sample()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>분양가격</th>
      <th>평당분양가격</th>
      <th>전용면적</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>774</th>
      <td>인천</td>
      <td>2016</td>
      <td>7</td>
      <td>3599.0</td>
      <td>11876.7</td>
      <td>102㎡~</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 버전에 따라 tolist() 로 동작하기도 합니다.
# to_list() 가 동작하지 않는다면 tolist() 로 해보세요.
df_last.columns.to_list()
```

<pre>
['지역명', '연도', '월', '분양가격', '평당분양가격', '전용면적']
</pre>

```python
cols = ['지역명', '연도', '월', '평당분양가격']
cols
```

<pre>
['지역명', '연도', '월', '평당분양가격']
</pre>

```python
# 최근 데이터가 담긴 df_last 에는 전용면적이 있습니다. 
# 이전 데이터에는 전용면적이 없기 때문에 "전체"만 사용하도록 합니다.
# loc를 사용해서 전체에 해당하는 면적만 copy로 복사해서 df_last_prepare 변수에 담습니다.
df_last_prepare = df_last.loc[
    df_last["전용면적"] == "전체", cols].copy()
df_last_prepare.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2015</td>
      <td>10</td>
      <td>19275.3</td>
    </tr>
  </tbody>
</table>
</div>

```python
# df_first_melt에서 공통된 컬럼만 가져온 뒤
# copy로 복사해서 df_first_prepare 변수에 담습니다.
df_first_prepare = df_first_melt[cols].copy()
df_first_prepare.head(1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013</td>
      <td>12</td>
      <td>18189</td>
    </tr>
  </tbody>
</table>
</div>

### concat 으로 데이터 합치기

* https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html

```python
# df_first_prepare 와 df_last_prepare 를 합쳐줍니다.

df = pd.concat([df_first_prepare, df_last_prepare])
df.shape
```

<pre>
(1224, 4)
</pre>

```python
# 제대로 합쳐졌는지 미리보기를 합니다.

df
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>지역명</th>
      <th>연도</th>
      <th>월</th>
      <th>평당분양가격</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>서울</td>
      <td>2013</td>
      <td>12</td>
      <td>18189.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>부산</td>
      <td>2013</td>
      <td>12</td>
      <td>8111.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구</td>
      <td>2013</td>
      <td>12</td>
      <td>8080.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>인천</td>
      <td>2013</td>
      <td>12</td>
      <td>10204.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>광주</td>
      <td>2013</td>
      <td>12</td>
      <td>6098.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4310</th>
      <td>전북</td>
      <td>2019</td>
      <td>12</td>
      <td>8144.4</td>
    </tr>
    <tr>
      <th>4315</th>
      <td>전남</td>
      <td>2019</td>
      <td>12</td>
      <td>8091.6</td>
    </tr>
    <tr>
      <th>4320</th>
      <td>경북</td>
      <td>2019</td>
      <td>12</td>
      <td>9616.2</td>
    </tr>
    <tr>
      <th>4325</th>
      <td>경남</td>
      <td>2019</td>
      <td>12</td>
      <td>10107.9</td>
    </tr>
    <tr>
      <th>4330</th>
      <td>제주</td>
      <td>2019</td>
      <td>12</td>
      <td>12810.6</td>
    </tr>
  </tbody>
</table>
<p>1224 rows × 4 columns</p>
</div>

```python
# 연도별로 데이터가 몇개씩 있는지 value_counts를 통해 세어봅니다.

df["연도"].value_counts(sort=False)
```

<pre>
연도
2013     17
2014    204
2015    187
2016    204
2017    204
2018    204
2019    204
Name: count, dtype: int64
</pre>

### pivot_table 사용하기

* https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-and-pivot-tables

```python
# 연도를 인덱스로, 지역명을 컬럼으로 평당분양가격을 피봇테이블로 그려봅니다.
t = pd.pivot_table(df, index="연도", columns="지역명", 
                   values="평당분양가격").round()
t
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>지역명</th>
      <th>강원</th>
      <th>경기</th>
      <th>경남</th>
      <th>경북</th>
      <th>광주</th>
      <th>대구</th>
      <th>대전</th>
      <th>부산</th>
      <th>서울</th>
      <th>세종</th>
      <th>울산</th>
      <th>인천</th>
      <th>전남</th>
      <th>전북</th>
      <th>제주</th>
      <th>충남</th>
      <th>충북</th>
    </tr>
    <tr>
      <th>연도</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>6230.0</td>
      <td>10855.0</td>
      <td>6473.0</td>
      <td>6168.0</td>
      <td>6098.0</td>
      <td>8080.0</td>
      <td>8321.0</td>
      <td>8111.0</td>
      <td>18189.0</td>
      <td>7601.0</td>
      <td>8090.0</td>
      <td>10204.0</td>
      <td>5678.0</td>
      <td>6282.0</td>
      <td>7674.0</td>
      <td>6365.0</td>
      <td>6589.0</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>6332.0</td>
      <td>10509.0</td>
      <td>6729.0</td>
      <td>6536.0</td>
      <td>7588.0</td>
      <td>8286.0</td>
      <td>8240.0</td>
      <td>9180.0</td>
      <td>18997.0</td>
      <td>8085.0</td>
      <td>8362.0</td>
      <td>10075.0</td>
      <td>5719.0</td>
      <td>6362.0</td>
      <td>7855.0</td>
      <td>6682.0</td>
      <td>6620.0</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>6831.0</td>
      <td>10489.0</td>
      <td>7646.0</td>
      <td>7035.0</td>
      <td>7956.0</td>
      <td>8707.0</td>
      <td>8105.0</td>
      <td>9633.0</td>
      <td>19283.0</td>
      <td>8641.0</td>
      <td>9273.0</td>
      <td>10277.0</td>
      <td>6109.0</td>
      <td>6623.0</td>
      <td>7465.0</td>
      <td>7024.0</td>
      <td>6700.0</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>7011.0</td>
      <td>11220.0</td>
      <td>7848.0</td>
      <td>7361.0</td>
      <td>8899.0</td>
      <td>10310.0</td>
      <td>8502.0</td>
      <td>10430.0</td>
      <td>20663.0</td>
      <td>8860.0</td>
      <td>10209.0</td>
      <td>10532.0</td>
      <td>6489.0</td>
      <td>6418.0</td>
      <td>9129.0</td>
      <td>7331.0</td>
      <td>6770.0</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>7127.0</td>
      <td>11850.0</td>
      <td>8120.0</td>
      <td>7795.0</td>
      <td>9464.0</td>
      <td>11456.0</td>
      <td>9045.0</td>
      <td>11578.0</td>
      <td>21376.0</td>
      <td>9135.0</td>
      <td>11345.0</td>
      <td>10737.0</td>
      <td>7188.0</td>
      <td>7058.0</td>
      <td>10831.0</td>
      <td>7456.0</td>
      <td>6763.0</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>7681.0</td>
      <td>13186.0</td>
      <td>9019.0</td>
      <td>8505.0</td>
      <td>9856.0</td>
      <td>12076.0</td>
      <td>10180.0</td>
      <td>12998.0</td>
      <td>22889.0</td>
      <td>10355.0</td>
      <td>10241.0</td>
      <td>11274.0</td>
      <td>7789.0</td>
      <td>7626.0</td>
      <td>11891.0</td>
      <td>8013.0</td>
      <td>7874.0</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>8142.0</td>
      <td>14469.0</td>
      <td>9871.0</td>
      <td>8857.0</td>
      <td>11823.0</td>
      <td>13852.0</td>
      <td>11778.0</td>
      <td>13116.0</td>
      <td>26131.0</td>
      <td>11079.0</td>
      <td>10022.0</td>
      <td>12635.0</td>
      <td>7902.0</td>
      <td>8197.0</td>
      <td>12138.0</td>
      <td>8607.0</td>
      <td>7575.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 위에서 그린 피봇테이블을 히트맵으로 표현해 봅니다.
plt.figure(figsize=(15, 7))
sns.heatmap(t, cmap="Blues", annot=True, fmt=".0f")
```

<img width="854" alt="apt_price_29" src="https://github.com/zacinthepark/TIL/assets/86648892/3e32e6bb-724a-45fe-b114-0183aca33bee">

```python
# transpose 를 사용하면 행과 열을 바꿔줄 수 있습니다.

t.transpose()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>연도</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
    </tr>
    <tr>
      <th>지역명</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강원</th>
      <td>6230.0</td>
      <td>6332.0</td>
      <td>6831.0</td>
      <td>7011.0</td>
      <td>7127.0</td>
      <td>7681.0</td>
      <td>8142.0</td>
    </tr>
    <tr>
      <th>경기</th>
      <td>10855.0</td>
      <td>10509.0</td>
      <td>10489.0</td>
      <td>11220.0</td>
      <td>11850.0</td>
      <td>13186.0</td>
      <td>14469.0</td>
    </tr>
    <tr>
      <th>경남</th>
      <td>6473.0</td>
      <td>6729.0</td>
      <td>7646.0</td>
      <td>7848.0</td>
      <td>8120.0</td>
      <td>9019.0</td>
      <td>9871.0</td>
    </tr>
    <tr>
      <th>경북</th>
      <td>6168.0</td>
      <td>6536.0</td>
      <td>7035.0</td>
      <td>7361.0</td>
      <td>7795.0</td>
      <td>8505.0</td>
      <td>8857.0</td>
    </tr>
    <tr>
      <th>광주</th>
      <td>6098.0</td>
      <td>7588.0</td>
      <td>7956.0</td>
      <td>8899.0</td>
      <td>9464.0</td>
      <td>9856.0</td>
      <td>11823.0</td>
    </tr>
    <tr>
      <th>대구</th>
      <td>8080.0</td>
      <td>8286.0</td>
      <td>8707.0</td>
      <td>10310.0</td>
      <td>11456.0</td>
      <td>12076.0</td>
      <td>13852.0</td>
    </tr>
    <tr>
      <th>대전</th>
      <td>8321.0</td>
      <td>8240.0</td>
      <td>8105.0</td>
      <td>8502.0</td>
      <td>9045.0</td>
      <td>10180.0</td>
      <td>11778.0</td>
    </tr>
    <tr>
      <th>부산</th>
      <td>8111.0</td>
      <td>9180.0</td>
      <td>9633.0</td>
      <td>10430.0</td>
      <td>11578.0</td>
      <td>12998.0</td>
      <td>13116.0</td>
    </tr>
    <tr>
      <th>서울</th>
      <td>18189.0</td>
      <td>18997.0</td>
      <td>19283.0</td>
      <td>20663.0</td>
      <td>21376.0</td>
      <td>22889.0</td>
      <td>26131.0</td>
    </tr>
    <tr>
      <th>세종</th>
      <td>7601.0</td>
      <td>8085.0</td>
      <td>8641.0</td>
      <td>8860.0</td>
      <td>9135.0</td>
      <td>10355.0</td>
      <td>11079.0</td>
    </tr>
    <tr>
      <th>울산</th>
      <td>8090.0</td>
      <td>8362.0</td>
      <td>9273.0</td>
      <td>10209.0</td>
      <td>11345.0</td>
      <td>10241.0</td>
      <td>10022.0</td>
    </tr>
    <tr>
      <th>인천</th>
      <td>10204.0</td>
      <td>10075.0</td>
      <td>10277.0</td>
      <td>10532.0</td>
      <td>10737.0</td>
      <td>11274.0</td>
      <td>12635.0</td>
    </tr>
    <tr>
      <th>전남</th>
      <td>5678.0</td>
      <td>5719.0</td>
      <td>6109.0</td>
      <td>6489.0</td>
      <td>7188.0</td>
      <td>7789.0</td>
      <td>7902.0</td>
    </tr>
    <tr>
      <th>전북</th>
      <td>6282.0</td>
      <td>6362.0</td>
      <td>6623.0</td>
      <td>6418.0</td>
      <td>7058.0</td>
      <td>7626.0</td>
      <td>8197.0</td>
    </tr>
    <tr>
      <th>제주</th>
      <td>7674.0</td>
      <td>7855.0</td>
      <td>7465.0</td>
      <td>9129.0</td>
      <td>10831.0</td>
      <td>11891.0</td>
      <td>12138.0</td>
    </tr>
    <tr>
      <th>충남</th>
      <td>6365.0</td>
      <td>6682.0</td>
      <td>7024.0</td>
      <td>7331.0</td>
      <td>7456.0</td>
      <td>8013.0</td>
      <td>8607.0</td>
    </tr>
    <tr>
      <th>충북</th>
      <td>6589.0</td>
      <td>6620.0</td>
      <td>6700.0</td>
      <td>6770.0</td>
      <td>6763.0</td>
      <td>7874.0</td>
      <td>7575.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
# 바뀐 행과 열을 히트맵으로 표현해 봅니다.

plt.figure(figsize=(15, 7))
sns.heatmap(t.T, cmap="Blues", annot=True, fmt=".0f")
```

<img width="861" alt="apt_price_30" src="https://github.com/zacinthepark/TIL/assets/86648892/e9defea8-5875-4b94-94fd-9b7f0717edd8">

```python
# Groupby로 그려봅니다. 인덱스에 ["연도", "지역명"] 을 넣고 그려봅니다.
g = df.groupby(["연도", "지역명"])["평당분양가격"].mean().unstack().round()
g
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>지역명</th>
      <th>강원</th>
      <th>경기</th>
      <th>경남</th>
      <th>경북</th>
      <th>광주</th>
      <th>대구</th>
      <th>대전</th>
      <th>부산</th>
      <th>서울</th>
      <th>세종</th>
      <th>울산</th>
      <th>인천</th>
      <th>전남</th>
      <th>전북</th>
      <th>제주</th>
      <th>충남</th>
      <th>충북</th>
    </tr>
    <tr>
      <th>연도</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>6230.0</td>
      <td>10855.0</td>
      <td>6473.0</td>
      <td>6168.0</td>
      <td>6098.0</td>
      <td>8080.0</td>
      <td>8321.0</td>
      <td>8111.0</td>
      <td>18189.0</td>
      <td>7601.0</td>
      <td>8090.0</td>
      <td>10204.0</td>
      <td>5678.0</td>
      <td>6282.0</td>
      <td>7674.0</td>
      <td>6365.0</td>
      <td>6589.0</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>6332.0</td>
      <td>10509.0</td>
      <td>6729.0</td>
      <td>6536.0</td>
      <td>7588.0</td>
      <td>8286.0</td>
      <td>8240.0</td>
      <td>9180.0</td>
      <td>18997.0</td>
      <td>8085.0</td>
      <td>8362.0</td>
      <td>10075.0</td>
      <td>5719.0</td>
      <td>6362.0</td>
      <td>7855.0</td>
      <td>6682.0</td>
      <td>6620.0</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>6831.0</td>
      <td>10489.0</td>
      <td>7646.0</td>
      <td>7035.0</td>
      <td>7956.0</td>
      <td>8707.0</td>
      <td>8105.0</td>
      <td>9633.0</td>
      <td>19283.0</td>
      <td>8641.0</td>
      <td>9273.0</td>
      <td>10277.0</td>
      <td>6109.0</td>
      <td>6623.0</td>
      <td>7465.0</td>
      <td>7024.0</td>
      <td>6700.0</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>7011.0</td>
      <td>11220.0</td>
      <td>7848.0</td>
      <td>7361.0</td>
      <td>8899.0</td>
      <td>10310.0</td>
      <td>8502.0</td>
      <td>10430.0</td>
      <td>20663.0</td>
      <td>8860.0</td>
      <td>10209.0</td>
      <td>10532.0</td>
      <td>6489.0</td>
      <td>6418.0</td>
      <td>9129.0</td>
      <td>7331.0</td>
      <td>6770.0</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>7127.0</td>
      <td>11850.0</td>
      <td>8120.0</td>
      <td>7795.0</td>
      <td>9464.0</td>
      <td>11456.0</td>
      <td>9045.0</td>
      <td>11578.0</td>
      <td>21376.0</td>
      <td>9135.0</td>
      <td>11345.0</td>
      <td>10737.0</td>
      <td>7188.0</td>
      <td>7058.0</td>
      <td>10831.0</td>
      <td>7456.0</td>
      <td>6763.0</td>
    </tr>
    <tr>
      <th>2018</th>
      <td>7681.0</td>
      <td>13186.0</td>
      <td>9019.0</td>
      <td>8505.0</td>
      <td>9856.0</td>
      <td>12076.0</td>
      <td>10180.0</td>
      <td>12998.0</td>
      <td>22889.0</td>
      <td>10355.0</td>
      <td>10241.0</td>
      <td>11274.0</td>
      <td>7789.0</td>
      <td>7626.0</td>
      <td>11891.0</td>
      <td>8013.0</td>
      <td>7874.0</td>
    </tr>
    <tr>
      <th>2019</th>
      <td>8142.0</td>
      <td>14469.0</td>
      <td>9871.0</td>
      <td>8857.0</td>
      <td>11823.0</td>
      <td>13852.0</td>
      <td>11778.0</td>
      <td>13116.0</td>
      <td>26131.0</td>
      <td>11079.0</td>
      <td>10022.0</td>
      <td>12635.0</td>
      <td>7902.0</td>
      <td>8197.0</td>
      <td>12138.0</td>
      <td>8607.0</td>
      <td>7575.0</td>
    </tr>
  </tbody>
</table>
</div>

```python
plt.figure(figsize=(15, 7))
sns.heatmap(g.T, annot=True, fmt=".0f", cmap="Greens")
```

<img width="860" alt="apt_price_31" src="https://github.com/zacinthepark/TIL/assets/86648892/e63afbea-e3d9-4c7d-9caf-564f07b652fc">

## 2013년부터 최근 데이터까지 시각화하기

### 연도별 평당분양가격 보기

```python
# barplot 으로 연도별 평당분양가격 그리기
sns.barplot(data=df, x="연도", y="평당분양가격")
```

<img width="856" alt="apt_price_32" src="https://github.com/zacinthepark/TIL/assets/86648892/42f273c7-e08a-4d38-81a7-29d45eadbede">

```python
# pointplot 으로 연도별 평당분양가격 그리기
plt.figure(figsize=(12, 4))
sns.pointplot(data=df, x="연도", y="평당분양가격", hue="지역명")
plt.legend(bbox_to_anchor=(1.02, 1), loc=2, borderaxespad=0.)
```

<img width="852" alt="apt_price_33" src="https://github.com/zacinthepark/TIL/assets/86648892/60c47e22-4aa5-4db6-8551-931af43c47ca">

```python
# 서울만 barplot 으로 그리기
df_seoul = df[df["지역명"] == "서울"].copy()
print(df_seoul.shape)

sns.barplot(data=df_seoul, x="연도", y="평당분양가격", color="b")
sns.pointplot(data=df_seoul, x="연도", y="평당분양가격")
```

<pre>
(72, 4)
</pre>

<img width="860" alt="apt_price_34" src="https://github.com/zacinthepark/TIL/assets/86648892/8acb3ce5-71fd-460c-be8a-45e110f5541d">

```python
# 연도별 평당분양가격 boxplot 그리기
sns.boxplot(data=df, x="연도", y="평당분양가격")
```

<img width="858" alt="apt_price_35" src="https://github.com/zacinthepark/TIL/assets/86648892/d832b785-626f-4bf8-a047-f11460add498">

```python
# boxplot보다 분포를 조금 더 확인할 수 있음
sns.boxenplot(data=df, x="연도", y="평당분양가격")
```

<img width="858" alt="apt_price_36" src="https://github.com/zacinthepark/TIL/assets/86648892/70490a46-19f9-4ba9-ac6d-0ac0927e10a1">

```python
# 연도별 평당분양가격 violinplot 그리기
plt.figure(figsize=(10, 4))
sns.violinplot(data=df, x="연도", y="평당분양가격").set_title("연도별 전국 평균 평당 분양가격(단위:천원)")
```

<img width="852" alt="apt_price_37" src="https://github.com/zacinthepark/TIL/assets/86648892/9032c51c-a75a-45dc-9023-cbb335152169">

```python
# 연도별 평당분양가격 swarmplot 그리기
plt.figure(figsize=(12, 5))
sns.violinplot(data=df, x="연도", y="평당분양가격")
sns.swarmplot(data=df.reset_index(drop=True), x="연도", y="평당분양가격", hue="지역명")
plt.legend(bbox_to_anchor=(1.02, 1), loc=2, borderaxespad=0.)
```

<img width="862" alt="apt_price_38" src="https://github.com/zacinthepark/TIL/assets/86648892/d5d41c60-6aa0-4bb8-bfad-631b9c280077">

### 지역별 평당분양가격 보기

```python
# barplot 으로 지역별 평당분양가격을 그려봅니다.
plt.figure(figsize=(12, 4))
sns.barplot(data=df, x="지역명", y="평당분양가격")
```

<img width="861" alt="apt_price_39" src="https://github.com/zacinthepark/TIL/assets/86648892/2d14eefe-ccd7-49a0-b51e-5d63243e20f4">

```python
# 위와 같은 그래프를 미리 연산을 하고 결과값으로 그리는 방법
# groupby 로 구하기
mean_price = df.groupby(["지역명"])["평당분양가격"].mean().to_frame().sort_values(by="평당분양가격", ascending=False)
```

```python
# groupby 로 했던 방법을 똑같이
# pivot_table 로 구하기
mean_price = df.pivot_table(index="지역명", values="평당분양가격").sort_values(by="평당분양가격", ascending=False)
```

```python
plt.figure(figsize=(12, 4))
sns.barplot(data=mean_price, x=mean_price.index, y="평당분양가격", palette="Blues_r")
```

<img width="858" alt="apt_price_40" src="https://github.com/zacinthepark/TIL/assets/86648892/cc7fc371-35d6-4581-bebb-3af8fd4a23b2">

```python
# boxplot 으로 지역별 평당분양가격을 그려봅니다.

plt.figure(figsize=(12, 4))
sns.boxplot(data=df, x="지역명", y="평당분양가격")
```

<img width="857" alt="apt_price_41" src="https://github.com/zacinthepark/TIL/assets/86648892/4f54c420-9305-4b79-8899-7a9322fcf925">

```python

plt.figure(figsize=(12, 4))
sns.boxenplot(data=df, x="지역명", y="평당분양가격")
```

<img width="855" alt="apt_price_42" src="https://github.com/zacinthepark/TIL/assets/86648892/64001ad1-ea2f-4ab0-96cf-e1870f3dda58">

```python
# violinplot 으로 지역별 평당분양가격을 그려봅니다.
plt.figure(figsize=(24, 4))
sns.violinplot(data=df, x="지역명", y="평당분양가격")
```

<img width="860" alt="apt_price_43" src="https://github.com/zacinthepark/TIL/assets/86648892/fae6a9de-d521-4e81-a54d-9d5c0aad486f">

```python
# swarmplot 으로 지역별 평당분양가격을 그려봅니다.

plt.figure(figsize=(24, 4))
sns.swarmplot(data=df.reset_index(drop=True), x="지역명", y="평당분양가격", hue="연도")
```

<img width="860" alt="apt_price_44" src="https://github.com/zacinthepark/TIL/assets/86648892/b888fcb7-93da-4f58-adc6-33faa2e54660">
